<div class="container">
    <button class="btn btn-danger mt-3 mb-3" routerLink="/sign-in">Back</button>
    <table class="w-100">
        <thead>
            <tr>
                <th scope="col">Full Name</th>
                <th scope="col">Full Name User</th>
                <th scope="col">Account Email</th>
                <th scope="col">Edit</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ user?.fullName }}</td>
                <td>{{ user?.fullNameUser }}</td>
                <td>{{ user?.accountEmail }}</td>
                <td>
                    <button class="btn btn-success" (click)="editUser(user)">Edit</button>
                </td>
            </tr>
        </tbody>
    </table>
    <nz-modal [(nzVisible)]="isVisible" nzTitle="Edit User" (nzOnCancel)="handleCancel()" (nzOnOk)="updateUser()">
        <form [formGroup]="formEditApiUser" nz-form nzLayout="vertical">
            <nz-form-item>
                <nz-form-label for="">Full Name</nz-form-label>
                <nz-form-control>
                    <input class="w-50" nz-input formControlName="fullName" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label for="">Full Name User</nz-form-label>
                <nz-form-control>
                    <input class="w-50" nz-input formControlName="fullNameUser" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label for="">Account Email</nz-form-label>
                <nz-form-control>
                    <input class="w-50" nz-input formControlName="accountEmail" />
                </nz-form-control>
            </nz-form-item>
        </form>
    </nz-modal>
    <div class="mt-4">
        <div class="row">
            <div class="col-4">
                <p class="text-center">Tên CV</p>
            </div>
            <div class="col-4">
                <p class="text-center">Mô tả</p>
            </div>
            <div class="col-4">
                <p class="text-center">Thao tác</p>
            </div>
        </div>
    </div>
    <!-- <form [formGroup]="formEdit">
        <div class="container" formArrayName="formParent">
            <ng-container *ngFor="let form of formParent.controls; let i = index;">
                <ng-container [formGroupName]="i">
                    <div class="row my-2">
                        <div class="col-4 pl-0">
                            <input class="w-100" formControlName="cvName" placeholder="Nhập tên CV" />
                        </div>
                        <div class="col-4 pl-0">
                            <input class="w-100" formControlName="cvDesciption" placeholder="Nhập mô tả" />
                        </div>
                        <div class="col-4">
                            <div class="d-flex justify-content-center">
                                <button class="btn btn-primary mr-2" (click)="addCV(i, index)">+</button> 
                                <button class="btn btn-dark" (click)="addExtraCV(form, j)">+</button>
                                <button [disabled]="i === 0" class="btn btn-danger ml-2" (click)="removeCV(i)">-</button>
                            </div>
                        </div>
                    </div>
                    <ng-container *ngIf="form.get('formChild').controls">
                        <ng-container formArrayName="formChild">
                            <div class="row my-2" *ngFor="let formChild of form.get('formChild').controls; let j = index;">
                                <ng-container [formGroupName]="j">
                                    <div class="col-4 ">
                                        <input class="w-100" formControlName="cvName" placeholder="Nhập tên CV" />
                                    </div>
                                    <div class="col-4 ">
                                        <input class="w-100" formControlName="cvDesciption" placeholder="Nhập mô tả" />
                                    </div>
                                    <div class="col-4">
                                        <div class="d-flex justify-content-center">
                                            <button class="btn btn-primary mr-2" (click)="addCV(i, index)">+</button>
                                            <button class="btn btn-dark" (click)="addExtraCV(form, j)">+</button>
                                            <button class="btn btn-danger ml-2" (click)="removeExtraCV(form,j)">-</button>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>
                    </ng-container>
                </ng-container>
            </ng-container>
        </div>
    </form> -->
    
    <form [formGroup]="formEdit" *ngIf="formEdit">
        <ng-container class="container" formArrayName="works">
            <ng-container *ngTemplateOutlet="recursiveList; context:{ $implicit: formEdit.get('works'), padding: 0, stt: '' }"></ng-container>
        </ng-container>
    </form>
    
    
    <ng-template #recursiveList let-controls let-padding="padding" let-stt="stt">
        <ng-container *ngFor="let item of controls.controls; let i=index;">
            <ng-container [formGroup]="item">
                <div class="row my-2" [ngStyle]="{'margin-left': padding + 'px'}">
                    <div class="col-4 pl-0">
                        <div class="d-flex">
                            {{stt ? stt + '.' + (i + 1) : (i + 1)}}
                            <input class="w-100 ml-2" formControlName="cvName" placeholder="Nhập tên CV" />
                        </div>
                    </div>
                    <div class="col-4 pl-0">
                        <input class="w-100" formControlName="cvDesciption" placeholder="Nhập mô tả" />
                    </div>
                    <div class="col-4">
                        <div class="d-flex justify-content-center">
                            <button class="btn btn-primary mr-2" (click)="addFormParent(controls.controls)">+</button> 
                            <button class="btn btn-dark" (click)="addFormChild(item)">+</button>
                            <button class="btn btn-danger ml-2" (click)="removeCV(controls, i)">-</button>
                        </div>
                    </div>
                </div>
                <ng-container *ngIf="item.get('works')?.controls?.length > 0">          
                    <ng-container *ngTemplateOutlet="recursiveList; context:{ $implicit: item.get('works'), padding: padding + 10, stt: stt ? stt + '.' + (i + 1) : (i + 1) }"></ng-container>
                </ng-container>
            </ng-container>
        </ng-container>
    </ng-template>
</div>
